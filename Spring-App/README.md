# Spring App with Jenkins/Deno pipeline
[Kotlin](https://kotlinlang.org) / [Springboot](https://spring.io/projects/spring-boot) application sample with Jenkins/Deno pipeline. This project includes a Swagger (UI and JSON) generated by [SpringDoc](https://springdoc.org/) and data handling by [JPA](https://pt.wikipedia.org/wiki/Java_Persistence_API). In this tutorial, we use 3 layers (controllers, services and repositories). 

# Build

You can compile this project directly from IntelliJ or by typing `gradlew build` in a Windows Prompt or Linux shell.

# Live reload

In case you want to enable live reload in order to auto compile your code whenever you save a file when the project is running, follow the steps below in your IntelliJ:

1. Open IntellilJ Settings and go to `Build, Execution, Deployment/Compiler`. 
2. Enable the checkbox `Build project automatically` and save. 
3. Now, type `Ctrl+Shift+A` and type  `registry...` inside the pop dialog. 
4. Mark the option `compiler.automake.allow.when.app.running`. 

That's all. You can now run/debug your spring boot project and, whenever you modify a file, IntelliJ will automatically compile the project again. :stuck_out_tongue_winking_eye: 

# Database

Currently, this project uses a PostgreSQL running in a Kubernetes cluster. In case you wish to modify and point to another database, change the lines below in [application.yaml](./src/main/resources/application.yaml): 

```yaml
  datasource:
    driverClassName: org.postgresql.Driver
    url: jdbc:postgresql://yoururl/postgres
    username: postgresadmin
    password: yourpass
```

# Swagger

The Swagger UI is generated at http://localhost:8080/swagger-ui.html and the json is generated at http://localhost:8080/v3/api-docs 

# Build/deployment pipeline

In case you want to test the build/deployment pipeline, you can use the [Jenkinsfile](./Jenkinsfile) provided in your Jenkins server or you can test directly from your local machine following the steps below:

1. Authenticate into aws, by executing: `gimme-aws-creds`
2. Type `pipeline.cmd`
3. Thats all :call_me_hand: . kkk. The `pipeline.cmd` above will execute a container using the [TinyOS](https://github.com/b12-144/TinyOS) image, which already includes jdk11, gradle and Deno. 
4. Than, `pipeline.cmd` passes the argument `allStages` to the [pipeline.ts](./pipeline.ts) written in Deno/typescript to execute all stages defined in the typescript file. 



Enjoy! :heart:

